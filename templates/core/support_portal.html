{% extends 'base.html' %}

{% block title %}Customer Portal - Domus{% endblock %}

{% block content %}
<div class="container-fluid px-0">
    <div class="row">
        <div class="col-12">
            <h1 class="mb-4">
                <i class="bi bi-headset"></i> Customer Portal
            </h1>
            
            {% if token_missing %}
                <div class="alert alert-danger" role="alert">
                    <h4 class="alert-heading">
                        <i class="bi bi-exclamation-triangle"></i> Konfigurationsfehler
                    </h4>
                    <p>
                        Das Support Portal kann nicht angezeigt werden, da der <strong>AGIRA_TOKEN</strong> nicht konfiguriert ist.
                    </p>
                    <hr>
                    <p class="mb-0">
                        Bitte kontaktieren Sie Ihren Systemadministrator, um die Umgebungsvariable <code>AGIRA_TOKEN</code> zu setzen.
                    </p>
                </div>
            {% else %}
                <iframe 
                    src="https://agira.angermeier.net/embed/projects/3/issues/?token={{ agira_token }}"
                    style="width: 100%; height: 100vh; border: none;"
                    title="Agira Support Portal"
                    sandbox="allow-same-origin allow-scripts allow-forms allow-popups"
                    referrerpolicy="strict-origin-when-cross-origin">
                </iframe>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
